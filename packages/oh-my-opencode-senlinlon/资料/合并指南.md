# 从官方仓库合并更新指南

## 前置条件

确保已配置 upstream remote：
```bash
git remote -v
# 应显示:
# origin    https://gitcode.com/senlinlon/oh-my-opencode-senlinlon.git
# upstream  https://github.com/code-yeongyu/oh-my-opencode.git
```

## 合并步骤

### 1. 拉取官方更新
```bash
cd /Users/工作2/opencode工作区/opencode/packages/oh-my-opencode-senlinlon
git fetch upstream
```

### 2. 查看差异
```bash
git diff senlinlon-integrated upstream/dev
git log senlinlon-integrated..upstream/dev --oneline
```

### 3. 合并更新
```bash
git checkout senlinlon-integrated
git merge upstream/dev
```

### 4. 解决冲突

**冲突解决原则**：
1. `package.json`: 保留我们的包名和依赖格式，合并新依赖
2. `src/cli/`: 忽略（我们不需要 CLI）
3. 配置文件: 保留我们的文件名，合并新配置选项

### 5. 重新执行字符串替换

```bash
grep -r "oh-my-opencode.json" --include="*.ts" src/
grep -r "code-yeongyu/oh-my-opencode" --include="*.ts" src/
```

### 6. 测试构建

```bash
cd /Users/工作2/opencode工作区/opencode
bun install
cd packages/oh-my-opencode-senlinlon
bun run build
```

### 7. 提交和推送

```bash
git add .
git commit -m "chore: merge upstream oh-my-opencode vX.X.X"
git push
```

## 需要重点检查的文件

| 文件 | 检查内容 |
|------|----------|
| `package.json` | 新依赖、版本号更新 |
| `src/index.ts` | 新导出、API 变化 |
| `src/hooks/` | 新 hooks |
| `src/tools/` | 新 tools |
| `src/agents/` | agent prompt 更新 |
| `src/features/` | 新功能 |

## 合并后验证清单

- [ ] `bun run build` 成功
- [ ] 无 TypeScript 类型错误
- [ ] 配置文件名仍为 `oh-my-opencode-senlinlon.json`
- [ ] 无 CLI 相关代码
- [ ] 插件可正常注册
